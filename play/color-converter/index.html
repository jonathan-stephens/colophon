<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Color Converter</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 600px; margin: 20px auto; padding: 0 20px; }
    #preview { width: 100%; height: 100px; border: 1px solid #ccc; margin: 20px 0; border-radius: 8px; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input { width: 100%; padding: 8px; margin-top: 5px; font-family: monospace; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; }
    input:focus { outline: none; border-color: #4a90e2; }
  </style>
</head>
<body>
  <h1>Color Converter</h1>
  <div id="preview" aria-label="Color preview"></div>

  <label for="hex">HEX / HEXA</label>
  <input type="text" id="hex" placeholder="#FF5733 or #FF5733FF">

  <label for="rgb">RGB / RGBA</label>
  <input type="text" id="rgb" placeholder="rgb(255, 87, 51) or rgba(255, 87, 51, 1)">

  <label for="hsl">HSL / HSLA</label>
  <input type="text" id="hsl" placeholder="hsl(9, 100%, 60%) or hsla(9, 100%, 60%, 1)">

  <label for="hsv">HSV / HSVA</label>
  <input type="text" id="hsv" placeholder="hsv(9, 80%, 100%)">

  <label for="hwb">HWB</label>
  <input type="text" id="hwb" placeholder="hwb(9 20% 0%)">

  <label for="cmyk">CMYK</label>
  <input type="text" id="cmyk" placeholder="0%, 66%, 80%, 0%">

  <label for="lab">LAB</label>
  <input type="text" id="lab" placeholder="lab(62.83 52.78 39.78)">

  <label for="lch">LCH</label>
  <input type="text" id="lch" placeholder="lch(62.83 66.13 37)">

  <label for="oklab">OKLAB</label>
  <input type="text" id="oklab" placeholder="oklab(0.68 0.15 0.10)">

  <label for="oklch">OKLCH</label>
  <input type="text" id="oklch" placeholder="oklch(0.68 0.18 35)">

  <script src="https://colorjs.io/dist/color.global.js"></script>
  <script>
    const preview = document.getElementById('preview');
    const inputs = {
      hex: document.getElementById('hex'),
      rgb: document.getElementById('rgb'),
      hsl: document.getElementById('hsl'),
      hsv: document.getElementById('hsv'),
      hwb: document.getElementById('hwb'),
      cmyk: document.getElementById('cmyk'),
      lab: document.getElementById('lab'),
      lch: document.getElementById('lch'),
      oklab: document.getElementById('oklab'),
      oklch: document.getElementById('oklch')
    };

    function parseColor(str, space) {
      try {
        // Clean up input
        str = str.trim();

        // For hex, add # if missing
        if (space === 'hex' && !str.startsWith('#')) {
          str = '#' + str;
        }

        // For plain number formats, wrap in function notation
        if (space === 'rgb' && /^\d+\s*,/.test(str)) {
          str = `rgb(${str})`;
        }
        if (space === 'hsl' && /^\d+\s*,/.test(str)) {
          str = `hsl(${str})`;
        }
        if (space === 'hsv' && /^\d+\s*,/.test(str)) {
          str = `color(--hsv ${str.replace(/,/g, '')})`;
        }
        if (space === 'cmyk' && /^\d/.test(str)) {
          str = `color(--cmyk ${str.replace(/,/g, '').replace(/%/g, '')})`;
        }

        return new Color(str);
      } catch (e) {
        return null;
      }
    }

    function formatValue(color, space) {
      try {
        const coords = color.to(space).coords;
        const alpha = color.alpha;

        switch(space) {
          case 'srgb':
            const [r, g, b] = coords.map(v => Math.round(v * 255));
            return alpha < 1
              ? `rgba(${r}, ${g}, ${b}, ${alpha.toFixed(2)})`
              : `rgb(${r}, ${g}, ${b})`;

          case 'hsl':
            const [h, s, l] = coords;
            return alpha < 1
              ? `hsla(${h.toFixed(0)}, ${s.toFixed(0)}%, ${l.toFixed(0)}%, ${alpha.toFixed(2)})`
              : `hsl(${h.toFixed(0)}, ${s.toFixed(0)}%, ${l.toFixed(0)}%)`;

          case 'hsv':
            const hsv = coords;
            return alpha < 1
              ? `${hsv[0].toFixed(0)}, ${hsv[1].toFixed(0)}%, ${hsv[2].toFixed(0)}%, ${alpha.toFixed(2)}`
              : `${hsv[0].toFixed(0)}, ${hsv[1].toFixed(0)}%, ${hsv[2].toFixed(0)}%`;

          case 'hwb':
            const [h2, w, bl] = coords;
            return alpha < 1
              ? `hwb(${h2.toFixed(0)} ${w.toFixed(0)}% ${bl.toFixed(0)}% / ${alpha.toFixed(2)})`
              : `hwb(${h2.toFixed(0)} ${w.toFixed(0)}% ${bl.toFixed(0)}%)`;

          case 'cmyk':
            const [c, m, y, k] = coords.map(v => (v * 100).toFixed(0));
            return `${c}%, ${m}%, ${y}%, ${k}%`;

          case 'lab':
            const [lL, lA, lB] = coords;
            return alpha < 1
              ? `lab(${lL.toFixed(2)} ${lA.toFixed(2)} ${lB.toFixed(2)} / ${alpha.toFixed(2)})`
              : `lab(${lL.toFixed(2)} ${lA.toFixed(2)} ${lB.toFixed(2)})`;

          case 'lch':
            const [lchL, lchC, lchH] = coords;
            return alpha < 1
              ? `lch(${lchL.toFixed(2)} ${lchC.toFixed(2)} ${lchH.toFixed(2)} / ${alpha.toFixed(2)})`
              : `lch(${lchL.toFixed(2)} ${lchC.toFixed(2)} ${lchH.toFixed(2)})`;

          case 'oklab':
            const [okL, okA, okB] = coords;
            return alpha < 1
              ? `oklab(${okL.toFixed(4)} ${okA.toFixed(4)} ${okB.toFixed(4)} / ${alpha.toFixed(2)})`
              : `oklab(${okL.toFixed(4)} ${okA.toFixed(4)} ${okB.toFixed(4)})`;

          case 'oklch':
            const [oklchL, oklchC, oklchH] = coords;
            return alpha < 1
              ? `oklch(${oklchL.toFixed(4)} ${oklchC.toFixed(4)} ${oklchH.toFixed(2)} / ${alpha.toFixed(2)})`
              : `oklch(${oklchL.toFixed(4)} ${oklchC.toFixed(4)} ${oklchH.toFixed(2)})`;
        }
      } catch (e) {
        return '';
      }
    }

    function updateAll(sourceType, color) {
      if (!color) return;

      // Update preview
      preview.style.backgroundColor = color.display();

      // Update all fields except source
      if (sourceType !== 'hex') {
        inputs.hex.value = color.to('srgb').toString({format: 'hex'});
      }

      if (sourceType !== 'rgb') {
        inputs.rgb.value = formatValue(color, 'srgb');
      }

      if (sourceType !== 'hsl') {
        inputs.hsl.value = formatValue(color, 'hsl');
      }

      if (sourceType !== 'hsv') {
        inputs.hsv.value = formatValue(color, 'hsv');
      }

      if (sourceType !== 'hwb') {
        inputs.hwb.value = formatValue(color, 'hwb');
      }

      if (sourceType !== 'cmyk') {
        inputs.cmyk.value = formatValue(color, 'cmyk');
      }

      if (sourceType !== 'lab') {
        inputs.lab.value = formatValue(color, 'lab');
      }

      if (sourceType !== 'lch') {
        inputs.lch.value = formatValue(color, 'lch');
      }

      if (sourceType !== 'oklab') {
        inputs.oklab.value = formatValue(color, 'oklab');
      }

      if (sourceType !== 'oklch') {
        inputs.oklch.value = formatValue(color, 'oklch');
      }
    }

    // Set up event listeners
    const spaceMap = {
      hex: 'hex',
      rgb: 'srgb',
      hsl: 'hsl',
      hsv: 'hsv',
      hwb: 'hwb',
      cmyk: 'cmyk',
      lab: 'lab',
      lch: 'lch',
      oklab: 'oklab',
      oklch: 'oklch'
    };

    for (const [type, input] of Object.entries(inputs)) {
      input.addEventListener('input', () => {
        const color = parseColor(input.value, type);
        if (color) updateAll(type, color);
      });
    }

    // Initialize with default color
    const defaultColor = new Color('#FF5733');
    updateAll('hex', defaultColor);
  </script>
</body>
</html>
